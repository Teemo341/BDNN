Namespace(batch_size=256, dataset='mnist', eva_iter=10, gpu=0, imageSize=28, network='resnet', num_classes=10, out_dataset='svhn', pre_trained_net='save_resnet_mnist/final_model', seed=0, test_batch_size=1000)
/home/siu170066/miniconda3/envs/sdenet/lib/python3.8/site-packages/torch/cuda/__init__.py:52: UserWarning: CUDA initialization: CUDA unknown error - this may be due to an incorrectly set up environment, e.g. changing env variable CUDA_VISIBLE_DEVICES after program start. Setting the available devices to be zero. (Triggered internally at  /opt/conda/conda-bld/pytorch_1607370131125/work/c10/cuda/CUDAFunctions.cpp:100.)
  return torch._C._cuda_getDeviceCount() > 0
Random Seed:  0
Load model
load target data:  mnist
Building MNIST data loader with 1 workers
load non target data:  svhn
Building SVHN data loader with 1 workers
Using downloaded and verified file: ../data/svhn/train_32x32.mat
Using downloaded and verified file: ../data/svhn/test_32x32.mat
generate log from in-distribution data

 Final Accuracy: 9952/10000 (99.52%)
 
generate log  from out-of-distribution data
calculate metrics for OOD
OOD  Performance of Baseline detector
TNR at TPR 95%:            90.187%
AUROC:                     96.500%
Detection acc:             92.745%
AUPR In:                   89.223%
AUPR Out:                  98.680%
calculate metrics for mis
mis  Performance of Baseline detector
TNR at TPR 95%:            87.500%
AUROC:                     96.048%
Detection acc:             91.750%
AUPR In:                   99.977%
AUPR Out:                  29.876%
